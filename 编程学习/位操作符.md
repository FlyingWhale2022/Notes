---
tags: C语言
aliases: 
创建时间: 2023-08-02 19:52
---

# 位操作符

`&` ：按位与
`|` ：按位或
`^` ：按位异或
`~` ：按位取反

注意：位操作符是对**整数的补码**进行操作的。

## 原码、反码和补码
### 原码

正数的原码：对应的二进制数。

负数的原码：按照绝对值大小转换成的二进制数，然后最高位（符号位）替换为1

符号位：是在二进制中用来表示一个数字的正或者负，是最高位(最左边的一位)，1表示负数，0表示正数。

![image.png](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202308021957682.png)


### 反码

正数的反码：与原码相同。

负数的反码：对该数的原码除符号位外各位取反(1变为 0，0变为1)

![image.png](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202308022001408.png)


### 补码

正数的补码：与原码相同。

负数的补码：对该数的原码除符号位外各位取反（就是负数本身的反码），然后在最后一位加1。即在反码的最后一位加1。

![image.png](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202308022005813.png)


注意： **整数（包括负数）** 的二进制就是**以补码的形式**在计算机中存储的。


## 按位与-&

按位与：两整数补码对应位上，如果同时为 1 ，则结果为 1 。

`&` 可用于逻辑判断：表达式 1 & 表达式 2。

>但需要注意的是，表达式 1 和表达式 2 的结果都必须为布尔值 `1` 或 `0` 。
>
>假如表达式 1 的结果为 1，表达式 2 的结果为 2，预期的结果应该为 1，但 `1 & 2` 的结果为 0。

[[按位与和“逻辑与”以及“按位或”和“逻辑或”之间的比较|& 和 &&比较]]




求一个整数存储在内存中的二进制中1的个数：
```c
int CalculateOne(int a) {
	int num = 0;
	for (int i = 1; i <= 32; i++) {
		if (a & 1) {
			num++;
		}
		a = a >> 1;//注意，移位操作符不改变值本身
	}
	return num;
}
```


## 按位或-|

按位或：两整数补码对应位上，如果有 1 ，则结果为 1 。

[[按位与和“逻辑与”以及“按位或”和“逻辑或”之间的比较|按位或和逻辑或的比较]]


## 按位异或-^

按位异或：两整数补码对应位上，如果相同，结果为 0；不同，结果为 1 。

按位异或的规律：
- 一个数和本身异或结果为 0 ：num 1 ^ num 1 = 0
- 一个数和 0 异或结果为本身：0 ^ num 1 = num 1
- 异或支持交换律：num 1 ^ num 2 ^ num 1 = num 1 ^ num 1 ^ num 2 = num 2


在不创建临时变量的情况下，交换两个变量的值：

```c
	int a = 10;
	int b = 20;

	a = a ^ b;
	b = a ^ b;
	a = b ^ a;

	printf("a =  %d b = %d\n", a, b);
```

## 按位取反-~

按位取反：对一个整数的补码按位取反