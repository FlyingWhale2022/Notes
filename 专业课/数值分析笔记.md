# 绪论

🌾Taylor 公式：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302123003.png)

---
🌾 绝对误差和相对误差

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092033230.png)

> 四舍五入之后，绝对误差为最后一位量级的 $1/2$

# 非线性方程的数值解法

## 二分法

🐳 零点存在定理

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302142050.png)

---
🐳 二分法

🍒 二分法基本思想：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302145062.png)

🍒 二分法主要过程如下：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302220558.png)

🍒 二分法的主要性质：

![image.png|550](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302225245.png)

🍒 二分法的误差

$$\left|x_n-x^*\right|\leq\frac{b-a}{2^{n+1}}$$
> n 取 $0,1,2,3...$ 

证明过程如下：

![image.png|850](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311021157339.png)

---
🐳 例题

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092047734.png)


## 不动点迭代法

### 不动点介绍

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061517589.png)

🍒 对于不动点的理解：

对于式子 $\varphi(x_{n})$，任取一个 $x_0$ 的值代入，将结果赋给 $x_1$ ，即 $x_1=\varphi(x_0)$。然后将 $x_1$ 重新代入公式计算，这样不断循环，最终 $x_{n+1}$ 会趋于一个稳定的值 $x^*$，即为不动点。

不动点满足： $x^{*}=\varphi(x^{*})$ 

> 1、迭代法在几何上的表示为：从一点出发，以“阶梯”的形式迭代，不断靠近相交点
> 2、这里的迭代函数形式不唯一

![image.png|725](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061706694.png)


🍒 不动点迭代法需要研究的问题：

![image.png|450](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061708201.png)


### 不动点迭代

🐳 不动点存在且迭代全局收敛条件

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061728986.png)

🍒 不动点存在证明：

使用[零点定理](https://baike.baidu.com/item/%E9%9B%B6%E5%80%BC%E5%AE%9A%E7%90%86/9607445)

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061712005.png)

🍒 迭代全局收敛性证明：

![image.png|675](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061739431.png)

> 什么是全局：
> 即在 $[a,b]$ 区间上任取一个初值点进行迭代，结果都能收敛，即收敛性与初值选取无关


🍒 收敛误差证明：

![image.png|550](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061740238.png)

> 无论是收敛证明还是迭代误差证明，都是使用该公式：$|x_{n}-x^{*}|\leq L|x_{n-1}-x^{*}|$ 
> 该公式是由拉格朗日中值定理推导出来的，要记住这个公式。

---
🐳 迭代局部收敛性

通常全局收敛的判别条件一般不容易验证，因此通常讨论迭代格式在 $x^*$ 处的局部收敛性。

🍒 迭代局部收敛性的定义：

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092115567.png)

> 即在 $x^*$ 的领域内任取一个初值，迭代都能收敛

🍒 迭代局部收敛性条件：

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092119821.png)

> 注意：$x^*$ 是未知的，因此通常用 $x^*$ 附近的值来近似替代 $\varphi(x^{*})$ 从而做判断，见下面例题

### 不动点迭代收敛性判断技巧

🌟 如果题目给出了区间，没有给出迭代初值，则利用不动点迭代全局收敛条件判断：

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061728986.png)

🌟 如果题目给出了迭代初值，没有给出区间，则利用不动点迭代局部收敛条件判断：

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092119821.png)

🍁看例题会有更深刻的理解

### 不动点迭代的收敛速度

🐳 收敛阶定义：

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061748738.png)

🐳 不动点迭代序列的收敛速度：

![image.png|725](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061901590.png)

> 🔥 注意：利用该方法判断收敛阶一定要知道不动点 $\boldsymbol{x}^{*}$ 的值
> 
> 💡 结论：基于不动点的收敛迭代（即迭代式是通过非线性方程变换而来，并非由其它方式构造而来，如后面的牛顿迭代法就是通过其它方式构造来的）基本都是线性一阶的


### 数列收敛加速原理

🐳 **Aitkin 加速收敛序列：**

![image.png|625](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061909528.png)

> Aitkin 加速并没有把组合值代入迭代中，而是将前后两次迭代的组合值 $y$ 计算出来，然后相减进行误差判断，如果符合误差限度，则停止迭代，将最后一次计算出的 $y$ 值作为计算结果，整个过程并没有改变迭代的值。
> 
> 但 Aitkin 加速作用体现在误差判断这一块。

---
🐳 **Steffensen 迭代法：**

![image.png|625](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309061911921.png)

> Steffensen 迭代法和 Aitkin 加速使用相同的组合结构，不同的是 Steffensen 迭代法会**把组合值代入迭代中**

### 例题

🌵 全局收敛性判读例题：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092142363.png)

---
🌵  全局收敛性判读例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092200306.png)

---
🌵 例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311092134533.png)

> 求解步骤：
> 1、由方程构建迭代函数
> 2、用一个值近似根，并判断该值的绝对值是否小于 1 且不等于 0
> 3、利用拉格朗日中值定理证明收敛阶数为 1（基于不动点的收敛迭代基本都是线性一阶的）
> 
> 🔥 注意：这里不能用“不动点迭代的收敛速度准则”判断，因为不知道不动点 $\boldsymbol{x}^{*}$ 的值

---
🌵 例题：求迭代式的收敛阶

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311100017646.png)

---
🌵 例题：

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121037491.png)
![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121038534.png)
![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121039227.png)

> 这道题有一定的技巧性：
> 首先通过 $-\sqrt{C}$ 来构造收敛阶
> 然后为了证明 $x_n$ 的收敛性，通过 $+\sqrt{C}$ 来构造等比数列


## 牛顿迭代法

### 牛顿迭代公式的推导

$f(x)$ 在 $x_0$ 处泰勒展开：

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309120932290.png)

当 $x_0$ 通过迭代无限趋向于根的时候，只取关于 $x$ 的线性项：

![image.png|375](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309120937281.png)

其解记为：

![image.png|202](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309120938535.png)

因此可构造迭代格式：

![image.png|500](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309120939228.png)

对应的几何意义：

![image.png|384](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309120940878.png)

> 通过不断做切线，使 $x_n$ 不断逼近根

---
💡 不动点迭代和牛顿迭代区别与联系

区别主要在于迭代式的构造方式：

- 不动点迭代通过对**非线性方程进行变换**，从而得到迭代式进行迭代
- 牛顿迭代是由泰勒展开式推导而来，将非线性方程视为一个**函数**，构造固定格式的迭代式进行迭代

联系在于：牛顿迭代可以看作是不动点迭代

### 牛顿法的收敛性
#### 牛顿迭代法的局部收敛性

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121445643.png)

运用了[[数值分析笔记#不动点迭代的收敛速度]]的定理来证明

> 注意局部收敛的条件：
> 1、只能为单重根，即 $f(x^*){=}0,f^{\prime}(x^*)\neq0$
> 2、初值要充分靠近根

#### 牛顿迭代法的全局收敛性

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121101355.png)

#### 判断牛顿迭代法收敛性技巧

🌟 如果只告诉了不动点 $\boldsymbol{x}^{*}$ 的值，则利用局部收敛判断条件

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121445643.png)

🌟 如果没有告诉不动点 $\boldsymbol{x}^{*}$ 的值，但告诉了区间，则利用全局收敛判断条件：

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121101355.png)

🔥 注意：牛顿迭代也属于一种不动点迭代格式，因此可以用“不动点迭代收敛速度判断准则”来判断收敛阶，详细见例题。

### 计算重根的牛顿迭代法

当有重根时，如果用通常的牛顿迭代公式，收敛速度为**一阶**，因此需要使用**修改后**的牛顿迭代公式

牛顿迭代公式修改一：[参考视频](https://www.bilibili.com/video/BV1P24y1b7oh?t=1005.0)

![image.png|700](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121510177.png)

> 该方法需要知道重数 m 的值

牛顿迭代公式修改二：[参考视频](https://www.bilibili.com/video/BV1P24y1b7oh?t=1899.0)

![image.png|700](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121532297.png)

> 分析可得 $x^*$ 是 $u(x)$ 的单根，因此可通过对 $u(x)$ 使用牛顿迭代法获得解，该方法的收敛速度至少为平方阶。

### 牛顿法解二元非线性方程组

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311100031074.png)


### 例题

🌵 例题： 求正数平方根算法

![image.png|475](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309121035298.png)

---
🌵 例题：利用“不动点迭代收敛速度准则”判断收敛阶

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311101252780.png)

> 这里知道不动点的值，因此可以用利用“不动点迭代收敛速度准则”判断收敛阶

---
🌵 例题：证明牛顿迭代法对于重根为线性收敛

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311121035713.png)

## 弦截法

迭代格式为：

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311120109863.png)

> 与牛顿迭代法不同的是，分母的导数变为：$\frac{f(x_{n})-f(x_{n-1})}{x_{n}-x_{n-1}}$，在迭代过程中涉及三个量

# 线性方程组的数值解法

线性方程组的矩阵形式：

![image.png|750](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309161751544.png)

## 克莱姆法则

![[克莱姆法则]]


## 高斯消元法

### 利用增广矩阵进行高斯消元

列出增广矩阵，然后分别进行第一轮消元、第二轮消元……

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309161919339.png)

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309161921844.png)

> 注意 $m_{ij}$  的求解方法，后面需要用的着


经过消元后，一般方程组化为上三角方程组：

![image.png|500](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309161927529.png)

根据上三角方程组依次求解 $x_4$ , $x_3$,... , $x_1$

### LU分解

以下面方程组进行说明：

![image.png|300](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309161934940.png)

进行第一轮消元：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231129500.png)

> 其中，'0.5' 为 $m_{21}=-(-\frac{4}{8})$，'-0.5' 为 $m_{31}=-(\frac{4}{8})$ ，'8'是主元

进行第二轮消元：
$$
F_2A^{(1)}=\begin{bmatrix}1\\&1\\&\color{red}0.5&1\end{bmatrix}\begin{bmatrix}8&-6&2\\&8&-6\\&-4&5\end{bmatrix}=A^{(2)}=\begin{bmatrix}\color{red}{8}&-6&2\\&\color{red}{8}&-6\\&&2\end{bmatrix}
$$
> 其中，'0.5' 为 $m_{32}$ ，'8'是主元

综合两式可得：
$$
\begin{aligned}
F_{2}F_{1}A& =\begin{bmatrix}1&&\\&1&\\&\color{red}0.5&1\end{bmatrix}\begin{bmatrix}1&&\\\color{red}0.5&1&\\\color{red}-0.5&&1\end{bmatrix}\begin{bmatrix}8&-6&2\\-4&11&-7\\4&-7&6\end{bmatrix}  \\
&=\begin{bmatrix}\color{red}{8}&-6&2\\&\color{red}{8}&-6\\&&\color{red}{2}\end{bmatrix}=A^{(2)}
\end{aligned}
$$

变换可得：
$$
A=F_1^{-1}F_2^{-1}A^{(2)}
$$

即：
$$
A=\begin{bmatrix}1\\\color{red}-0.5&1\\\color{red}0.5&&1\end{bmatrix}\begin{bmatrix}1\\&1\\&\color{red}-0.5&1\end{bmatrix}\begin{bmatrix}\color{red}{8}&-6&2\\&\color{red}{8}&-6\\&&\color{red}{2}\end{bmatrix}
$$
> $F_1^{-1}，F_2^{-1}$ 由 $F_1，F_2$ 矩阵的非对角元素加负号得到


记 $F_1^{-1}F_2^{-1}$ 为 $L$ （下三角矩阵），$A^{(2)}$ 为 $U$ （上三角矩阵）：
$$
L=\begin{bmatrix}1\\-0.5&1\\0.5&-0.5&1\end{bmatrix}=\begin{bmatrix}1\\-0.5&1\\0.5&&1\end{bmatrix}\begin{bmatrix}1\\&1\\&-0.5&1\end{bmatrix}
$$
>  $L$ 对角元素为 1，其它元素由 $F_1^{-1}，F_2^{-1}$ 的非对角元素组成 (- $m_{ij}$)

**注意**：下三角矩阵 $L$ 的一般表现形式：
$$
L=\begin{bmatrix}1\\-m_{21}&\ddots\\\vdots&\ddots&1\\-m_{n1}&\cdots&-m_{n,n-1}&1\end{bmatrix}
$$

> 因此把 $m_{ij}$ 求出来，直接用这个公式套就行（注意有个负号）


$$
U=\begin{bmatrix}\color{red}{8}&-6&2\\&\color{red}{8}&-6\\&&\color{red}{2}\end{bmatrix}
$$
> $U$ 为系数矩阵 $A$ 变换后的上三角矩阵

故可得：

$$
A=LU
$$
> 要注意 $L$ 和 $U$ 矩阵的求解方法

🌟 LU 分解书写格式：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311101317235.png)

---
🐳 将系数矩阵 LU 分解后，可快速求解方程组：

由 $Ax=b$ ，结合上式可得：
$$
LUx=b
$$

令 $Ux=Y$ ，可得：
$$
\begin{array}{l}LY=b\\Ux=Y\end{array}
$$

先求出 $Y=\{y_1,y_2,...,y_n\}$ ，然后求 $x=\{x_1,x_2,...,x_n\}$

> 因此 LU 分解法的重点在于求解上三角矩阵 $L$ 和下三角矩阵 $U$


例题：

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309162103249.png)

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309162104503.png)

### 三对角方程组（带状）的追赶法

[三对角方程组（带状）的追赶法](https://www.bilibili.com/video/BV1Ps4y1B7Lm?t=1.1)

![image.png|800](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309162117053.png)


## 经典迭代法

### 线性方程组迭代法的基本概念

![image.png|675](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171455717.png)

举例说明：

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171503083.png)

> 迭代步骤：
> 1、通过线性方程组分别表示出 $x_1,x_2,x_3,\ldots,x_n$ 
> 2、取 $X(0)$ 代入进行迭代
> 
> 要注意迭代矩阵 $B$ 和矩阵 $f$ 的求解方法


### 雅可比迭代法

雅可比迭代法运用的即为上述描述的基本迭代思想方法，只不过用了更规范的形式表现出来。

思想方法：
- 通过线性方程组分别表示出 $x_1,x_2,x_3,\ldots,x_n$ 
- 取 $X(0)$ 代入进行不断迭代得到 $X(n)$

![image.png|625](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171518602.png)

> 迭代式中参数说明：
> $a_{ii}$ 为第 $i$ 个方程中，$x_i$ 的系数
> 
> $\sum_{j=1}^{i-1}a_{ij}x_{j}^{(k)}$ 为第 $i$ 个方程中，$x_i$ 前半部分
> 
> $\sum_{j=i+1}^na_{ij}x_j^{(k)}]$ 为第 $i$ 个方程中，$x_i$ 后半部分

### 高斯-赛德尔迭代法

迭代公式：

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171529285.png)

高斯-赛德尔迭代法和雅可比迭代法的思想方法一致，但不同点在于：
高斯-赛德尔迭代会把该轮迭代中已经迭代出的 $x_{j}^{(k+1)}$ 代入当前迭代中，而雅可比迭代是直接使用上一轮迭代出的 $x_{j}^{(k)}$


举例说明：

![image.png|650](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171539620.png)


### 雅可比迭代法的矩阵表示

![image.png|675](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171610816.png)

故 $AX=b$ 可化为：

$$DX^{(k+1)}=(U+L)X^{(k)}+b$$
$$X^{(k+1)}=D^{-1}(U+L)X^{(k)}+D^{-1}b$$
记：$B_{J}=D^{-1}(U+L)$ ，$f_J={D}^{-1}b$，则上式可化为：
$$X^{(k+1)}=B_\mathbf{J}X^{(k)}+f_J$$

其中 $B_{J}$ 和 $f_J$ 的具体表现形式为：$f_{J}=D^{-1}\boldsymbol{b}$

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110124524.png)

> 1、需要记住 $D$，$L$ , $U$ 矩阵怎么来的
> 2、需要记住雅可比迭代法的矩阵表示公式

### 高斯-赛德尔迭代法的矩阵表示

将高斯-赛德尔迭代式化成如下格式：

![image.png|600](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171632501.png)

其矩阵的直观的表现形式为：

![image.png](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171635049.png)

以公式的形式展现为：

$$(D-L)X^{(k+1)}=UX^{(k)}+b$$
$$X^{(k+1)}=(D-L)^{–1}UX^{(k)}+(D-L)^{–1}b$$

记 $B_{\mathrm{G-S}}=(D-L)^{-1}U,f_{\mathrm{G-S}}=(D-L)^{-1}b$，可得高斯-赛德尔迭代格式：

$$X^{(k+1)}{=}B_{\mathbf{G-S}}X^{(k)}{+}f_{\mathbf{G-S}}$$

![image.png|700](https://zbn-picture-1319009493.cos.ap-guangzhou.myqcloud.com/public-pic/202309171641549.png)

> 1、需要记住 $D$，$L$ , $U$ 矩阵怎么来的
> 2、需要记住高斯-赛德尔迭代法的矩阵表示公式


## 迭代法的收敛性质

### 向量以及矩阵范数
#### 向量范数

🐳 向量范数的定义：

向量范数是对**向量**的某种**操作**（或者理解为是向量的某一函数），该操作需要满足以下三个条件：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310092006657.png)

通常用 $||x||$ 表示为向量 $x$ 的范数

---
🐳 常见的向量范数：

设  $x=(x_1,x_2,\cdots,x_n)^T\in{R}^n$ ，${R}^n$ 为 n 维向量空间，则有

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310092014017.png)

---
🐳 向量 2-范数**不变性**：

设矩阵 Q 为**正交矩阵**，即满足 $Q^TQ=I$ ，向量 $y$ 满足 $y=Qx$ ，则有：
$$\|y\|_2=\|x\|_2$$

证明： 
$$y^Ty=(Qx)^T(Qx)=x^TQ^TQx=x^Tx$$
$$\|y\|_2=\sqrt{y^Ty}=\sqrt{x^Tx}=\|x\|_2$$


---
🐳 证明： $\|x\|_\infty\leq\|x\|_1\leq n\|x\|_\infty$ 

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310102000929.png)

---
🐳 向量范数的相关定理：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310102002453.png)

> $V_n(P)$ 没啥特殊意义，就是泛指一个向量

#### 矩阵范数

🐳 **矩阵范数的定义**

![IMG_20231011_154254_edit_12723583336079.jpg](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111543309.jpg)


> $R^{m\times n}$ 没什么特殊意义，就泛指一个矩阵
> 注意：相比于向量范数，矩阵范数定义里面多了一个“**相容性**”

---
🐳 **相容性**

矩阵与矩阵相容：

![image.png|450](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111547791.png)

> 这里的 $A、B$ 都是矩阵

矩阵与向量相容：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121038659.png)

---
**矩阵范数的性质**

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121047314.png)

> 矩阵范数大于该矩阵的任一特征值；
> 换一种说法：**谱半径 $\rho\left(A\right)$ 是任意矩阵范数 $||A||$ 的下界**

证明：
![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121050065.png)

> 这里的 $||A||_m$ 代表矩阵范数

---
🐳 **矩阵算子范数**

> 对于矩阵算子范数不理解，可以观看：📺 [矩阵算子范数]( https://www.bilibili.com/video/BV1Q8411t7wh?t=1.5 ) 

定义：

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111551069.png)

矩阵算子范数由向量范数诱导出，如矩阵 2 范数的定义：

![image.png|425](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111558999.png)

> 这里的 $x\neq0$ 可以为其它条件，只要满足 $x\neq0$ 这一条件即可

---
🐳 **矩阵算子范数相关性质**

🍒 性质 1：

如果矩阵范数 $||A||$ 是向量范数 $||x||$ 的诱导矩阵范数（如下），则矩阵范数 $||A||$ 和向量范数 $||x||$ 相容。
$$\mid\mid A\mid\mid_a=\max_{x\neq0}\frac{\mid\mid Ax\mid\mid_a}{\mid\mid x\mid\mid_a}$$
> 就可以记忆为：诱导矩阵范数 $||A||$ 和相应的向量范数 $||x||$ 相容


🍒 性质 2：

$A^{-1}$ 的算子范数可表示为:
$$(\min_{x\neq0}\frac{\|Ax\|}{\|x\|})^{-1}$$ 
证明：
$$\|A^{-1}\|=\max_{x\neq0}\frac{\|A^{-1}x\|}{\|x\|}=\frac1{\min_{y\neq0}\frac{\|Ay\|}{\|y\|}}$$
> 这里令 $Ay=x$ 

---
🐳 **常见的矩阵范数**

$$\text{矩阵 }\infty\text{ 范数: }\left\|A\right\|_{\infty}=\max_{1\leqslant i\leqslant n}\sum_{j=1}^{n}\left|a_{ij}\right|$$
>极大行和范数，将每一行的数求和，然后取最大的那一个


$$\text{矩阵 1 范数:}\left\|A\right\|_{1}=\max_{1\leqslant j\leqslant n}\sum_{i=1}^{m}\left|a_{ij}\right|$$
> 极大列和范数，将每一列的数求和，然后取最大的那一个


$$\text{矩阵 2 范数: }\left\|A\right\|_{2}=\sqrt{\rho\left(A^{\mathrm{T}}A\right)}$$

> 谱范数
>🔥注意： 当 $A$ 为对称矩阵时，$\rho(A)=\left\|A\right\|_2$
$$\text{矩阵 F 范数: }\left\|A\right\|_{\mathrm{F}}=\sqrt{\sum_{i=1}^{m}\sum_{j=1}^{n}a_{ij}^{2}}$$

> 矩阵 $\infty$ 范数、1 范数、2 范数分别是向量 $\infty$ 范数、1 范数、2 范数的诱导矩阵范数
> 注意：矩阵 2 范数是最小的范数


#### 矩阵的条件数

🍒 条件数定义：
![image.png|425](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121124209.png)

🍒 条件数作用：

评估数值计算的稳定性
- 当条件数较大，则称为病态求解，方程组的解变化会较大；
- 当条件数较小，则称为良态求解，方程组的解变化会较小；

🍒 条件数的由来：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121126771.png)

🍒 常见的条件数：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311102254109.png)


### 收敛性分析

#### 向量序列的收敛性

参考教学视频：[向量序列的收敛性](https://www.bilibili.com/video/BV1DA411d73b?t=323.7)

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121328213.png)

> 向量序列的收敛性即向量各分量收敛
> 
> 注：$x^{(k)}$ 不是 $k$ 阶导的意思，可以理解为 $k$ 次迭代后的向量序列

向量序列收敛的条件也可以用如下条件等价：
$$\lim_{k\to\infty}\lVert x^{(k)}-x^*\rVert=0$$
#### 矩阵序列收敛

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121344464.png)


#### 迭代法的收敛性分析

##### 迭代法收敛判的充分必要条件


🐳 充分必要条件：对于迭代格式 $X^{(k+1)}=BX^{(k)}+f$ 收敛的充分必要条件为：迭代矩阵 B 的谱半径 $\rho\left(B\right)<1$ 


以下为证明过程（**只需了解**）：

首先计算迭代法误差：

对于雅可比和高斯-赛德尔迭代：
$$X^{(k+1)}=BX^{(k)}+f$$

记误差向量为：
$$\varepsilon^{(k)}=X^{(k)}-X^*\quad(k=0,1,2,3,\cdots\cdots)$$

由于 $X^*$ 未知，因此需要将误差向量可推导如下确定的形式：
$$\varepsilon^{(k)}=B\varepsilon^{(k-1)}$$
递推可得：
$$\varepsilon^{(k)}=B\cdot\varepsilon^{(k-1)}=B^2\cdot\varepsilon^{(k-2)}=\cdots=B^k\cdot\varepsilon^{(0)}$$
因此，研究向量序列 $x^{(k)}$ 的收敛性（或迭代法的收敛性）只需要研究矩阵 $B^k$ 的收敛性，即以下结论：
$$\lim_{k\to\infty}\varepsilon^{(k)}=0\quad\Longleftrightarrow\quad\lim_{k\to\infty}B^k=0$$
设存在一矩阵范数，使 $||B||{<}1$ ，由相容性可得：
$$\lim_{k\to\infty}\|\varepsilon^{(k)}\|\leq\lim_{k\to\infty}\|B\|^k\|\varepsilon^{(0)}\|=0$$

而 $lim_{k\to\infty}B^k=0$ 的充分必要条件为 $\rho\left(B\right)<1$ （证明过程复杂，省略）


##### 雅可比迭代收敛判别方法

🐳 **方法一**

🌟 判别方法：若线性方程组 $Ax=b$ 的系数矩阵 $A$ 为严格对角占优矩阵，则雅可比和高斯-赛德尔迭代法都收敛。（这是一个充分条件，不是必要）

>如果系数矩阵 $A$ 不是严格对角占优矩阵，则使用其它方法

严格对角占优矩阵定义：

![image.png|575](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121517422.png)

> 即对角线上的元素大于所在行其它元素绝对值之和

---
🐳 **方法二**

🌟 若 $\exists\vert\vert B\vert\vert<1$，则收敛。（这是一个充分条件，不是必要）

> $\exists$ 代表存在的意思，即存在一种矩阵范数，使得 $\vert\vert B\vert\vert<1$ 。通常用“列和范数”和“行和范数”来试验，如果满足则迭代法收敛，如果不满足，换其它方法

---
🐳 **方法三**

🌟 $\rho\left(B_{J}\right)<1$ （这是一个充分必要条件）

🎆如何计算 $\rho\left(B_{J}\right)$ ：

利用 $\vert\lambda E-B_J\vert=0$ 计算出 $B_J$ 的特征值，从而获得 $\rho\left(B_{J}\right)$ 。

💡这里有个规律，$\vert\lambda E-B_J\vert$ = $|A的主对角元素全部乘上\lambda，其余元素都不变|$ 

[参考视频](https://www.bilibili.com/video/BV14F411e7Ji?t=230.4&p=3)

---
🐳 **方法四**

🌟 系数矩阵 A 对称，对角线元素均大于0，且 $A$ 和 ${2D-A}$ 均为**正定矩阵**（充分必要条件）
其中 $D$ 为 A 的对角元素矩阵

> 该方法适用于系数矩阵 A 对称，对角线元素均大于0 的情况

🌵 正定矩阵的判别方法：
- 方法一：矩阵为对称矩阵，所有特征值大于 0
- 方法二：矩阵为对称矩阵，且所有顺序主子式都大于 0

💡什么是顺序主子式？

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310161031295.png)


##### 高斯-赛德尔迭代收敛判别方法

🍐 **方法一**

🌟 判别方法：若线性方程组 $Ax=b$ 的系数矩阵 $A$ 为严格对角占优矩阵，则雅可比和高斯-赛德尔迭代法都收敛。（这是一个充分条件，不是必要）

>如果系数矩阵 $A$ 不是严格对角占优矩阵，则使用其它方法

严格对角占优矩阵定义：

![image.png|575](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310121517422.png)

> 即对角线上的元素大于所在行其它元素绝对值之和

---
🍐 **方法二**

🌟 若 $\exists\vert\vert B\vert\vert<1$，则收敛。（这是一个充分条件，不是必要）

> $\exists$ 代表存在的意思，即存在一种矩阵范数，使得 $\vert\vert B\vert\vert<1$ 。通常用“列和范数”和“行和范数”来试验，如果满足则迭代法收敛，如果不满足，换其它方法

---
🍐 **方法三**

🌟 $\rho\left(B_{G}\right)<1$ （这是一个**充分必要**条件）

🎆如何计算 $\rho\left(B_{G}\right)$ ：

利用 $\vert\lambda E-B_G\vert=0$ 计算出 $B_G$ 的特征值，从而获得 $\rho\left(B_{G}\right)$ 。

💡这里有个规律，$\vert\lambda E-B_G\vert$ = $|A的下三角元素（包括对角线）全部乘上\lambda，其余元素都不变|$ 

[参考视频](https://www.bilibili.com/video/BV14F411e7Ji?t=476.3&p=6)

----
🍐 **方法四**

🌟 系数矩阵 A 对称，对角线元素均大于0，且为**正定矩阵**（充分必要条件）

> 该方法适用于系数矩阵 A 对称，对角线元素均大于0 的情况

正定矩阵的判别方法：
- 方法一：矩阵为对称矩阵，所有特征值大于 0
- 方法二：矩阵为对称矩阵，且所有顺序主子式都大于 0

💡什么是顺序主子式？

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310161031295.png)


##### 迭代误差估计


![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310122138226.png)

证明过程如下：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110012609.png)

### 例题

🌵 例题：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110019385.png)

> 系数矩阵 A 对称，对角线元素均大于0，故采用第四种方法判断收敛性

🔥 注意：对于这种特殊的行列式有以下的求解方法 :

![image.png|875](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110059964.png)

---
🌵 例题：

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110101112.png)

> 这里需要掌握特征值怎么求解

---
🌵 例题：

![image.png|925](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311110150430.png)



### 梯度下降法

**内积**

🐳内积（也称点积）运算：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131133281.png)

🐳内积的相关性质：

![image.png|475](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131116224.png)

---
**梯度**

对于梯度的直观理解可参考视频：[梯度理解](https://www.bilibili.com/video/BV1DD4y1374s?t=1.5)

🐳梯度的性质：

函数上的**某一点**，如果沿着函数梯度的方向运动，那么函数增加的最快；如果沿着函数梯度的反方向运动，函数减小的最快。

> 注意：梯度只是表示在该点，函数增加的最快

🐳梯度的求解：

梯度是一个方向向量，各分量分别为函数对各变量的偏导

$$\nabla f(\theta_1,\theta_2,......\theta_n)=(\frac{\partial\mathbf{f}}{\partial\theta_1},\frac{\partial\mathbf{f}}{\partial\theta_2},...,\frac{\partial\mathbf{f}}{\partial\theta_n})$$

---
**模函数**

🍉模函数 $\varphi(x)$ 定义：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131121506.png)

🍉 模函数 $\varphi(x)$ 性质：

- 对一切 $x\in{R}^n$ ，有
$$\nabla\varphi(x)=\mathrm{grad}\varphi(x)=Ax-b=-r$$ 
> $\nabla\varphi(x)，\mathrm{grad}\varphi(x)$ 表示模函数的梯度
> $r$ 表示负梯度
> 
> 这里的 ${R}^n$ 泛指向量

- 对一切 $x,y\in R^{n},\alpha\in R$：
$$\varphi(x+\alpha y)=\varphi(x)+\alpha(Ax-b,y)+\frac{\alpha^2}2(Ay,y)$$

---
**利用模函数求解线性方程组的解**

🍒求解依据：

![image.png|775](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131157470.png)

> 使模函数取极小值的 $x$ ，即为线性方程组 $Ax=b$ 的解


🍒 利用迭代求模函数的极小值点：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131330921.png)

> 就是构建迭代式 $x^{(k+1)}$ ，使得 $\varphi(x^{(k+1)})$ 不断减小，从而逼近极小值

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131334153.png)

使得 $\varphi(x^{(k+1)})$ 达到最小的 $\alpha_{_k}$ 为最优步长，经过推导 $\alpha_{_k}$ 可表示为：
$$\alpha_{k}=\frac{(r^{(k)},p^{(k)})}{(Ap^{(k)},p^{(k)})}$$

> $r^{(k)}$ 为负梯度
> $p^{(k)}$ 为搜索方向
> $A$ 为方程组的系数矩阵


#### 最速下降法

📺[最速下降法讲解视频](https://www.bilibili.com/video/BV16a4y1t76z?t=0.8)

🌶️最速下降法：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131732189.png)

> 搜寻方向 $p^{(\mathbf{k})}$ 为负梯度方向 $r$ 

🌶️最速下降法算法： 

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310131820668.png)

🌶️最速下降法分析：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310140208442.png)

- 相邻两次的搜索方向是正交的，即：
$$(r^{(k+1)},r^{(k)})=0$$

- 最速下降方向反映了目标函数的一种局部性质 。它**只是局部目标函数值下降最快的方向**。
- $x_{k+1}$ 为搜索方向 $r^{(k)}$ 与等值面的切点

🌶️最速下降法的简单理解

假设你站在山上的某一处，你要到山底。
首先，你站在原处环视一周，找到下山最快的方向（即该点的梯度方向），然后沿着该方向下山；
沿着该方向走多远停下来呢？停留的位置是当前方向的最低点（走的距离即为最优 $\alpha$ ）；
继续环视一周，找好新的前进方向，走到山底。

# 矩阵特征值与特征向量计算

## 幂法

### 幂法求解

幂法求矩阵 A **按模最大**特征值和相应的特征向量的近似解

🎆 适用于大型稀疏矩阵

🍒幂法求解思想：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310211611515.png)

> 思想了解一下就行，主要记住这个迭代序列

🍐迭代计算公式为：

$$\begin{cases}\lambda_k=\max_i\mid x_i^{(k)}\mid=\|x^{(k)}\|_\infty \\y_i^{(k)}=x_i^{(k)}/\lambda_k\\x^{(k+1)}=Ay^{(k)}\end{cases}$$

> $\lambda_k$ 为迭代出的特征值，等于向量 $x^{(k)}$ 的无穷范数
> 
> $y_i^{(k)}$ 为迭代出的特征向量的各分量
>   
> $x^{(k)}$ 为中间向量，通常题目会给出 $x^{(0)}$

⌛举例说明：

![image.png|850](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310161506566.png)


### 幂法的加速

#### 原点移位法

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310161511928.png)

> 与常规的幂法不同的是：需要找一个 $\lambda_0$（题目会告诉按模最大特征值在某个值附近，这个值可以充当 $\lambda_0$ ），按幂法求解 $A-\lambda_0I$ 的按模最大特征值 $\lambda^*_1$，最后所求的按模最大特征值为：$\lambda_1=\lambda_1^*+\lambda_0$ 

#### 幂法的埃特肯（Aitken）加速

幂法的埃特肯修正公式为：
$$\lambda_{修正}=\lambda_{n+2}-\frac{(\lambda_{n+2}-\lambda_{n+1})^{2}}{\lambda_{n+2}-2\lambda_{n+1}+\lambda_{n}}$$
为了使用埃特肯加速，需要先迭代两次，计算出 $\lambda_{1}$、$\lambda_{2}$ 才能使用

💻 加速算法为：

![image.png|900](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311121514272.png)

#### Rayleigh 商（瑞利商）加速法

🐳 Rayleigh 商定义：

设 $A$ 对称，$x\neq0$ ，则称 $R(x)=\frac{x^TAx}{x^Tx}$ 为 $x$ 关于 $A$ 的 Rayleigh 商

🐳 Rayleigh 商修正公式：
$$\begin{cases}y^{(k)}=\dfrac{x^{(k)}}{\max(x^{(k)})},\\x^{(k+1)}=Ay^{(k)},\\R(y^{(k)})=\dfrac{(y^{(k)})^TAy^{(k)}}{(y^{(k)})^T(y^{(k)})}=\dfrac{(y^{(k)})^{\mathrm{T}}x^{(k+1)}}{(y^{(k)})^{\mathrm{T}}(y^{(k)})}.\end{cases}$$

迭代出 3 个 Rayleigh 商后，利用 Aitken 修正公式计算特征值：
$$\lambda_{修正}=R(x^{(k+2)})-\frac{[R(x^{(k+2)})-R(x^{(k+1)})]^2}{R(x^{(k+2)})-2R(x^{(k+1)})+R(x^{(k)})}$$

## 反幂法

反幂法求矩阵 A **按模最小**特征值和相应的特征向量

🍐反幂法思想：

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310170042014.png)


⌛举例说明：

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/20231017004713.png)
![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310170046018.png)

> $Ax^{(k+1)}=y^{(k)}$ 为反幂法的迭代式
> 
> 将矩阵 A 进行[[ L-U 分解]]是为了更好解方程组求出 $x^{(k+1)}$ 
> 
> $\mu^{(k+1)}=\mathbf{max}(x^{(k+1)}_i)=\|x^{(k+1)}\|_\infty$ 
> 
> 迭代出的特征值： $\lambda^{(k+1)}=\frac1{\mu^{(k+1)}}$ 
> 
> 迭代出的特征向量： $y^{(k+1)}=\frac {x^{(k +1)}} {\mu^{(k+1)}}$ 

💻算法思路：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310170112199.png)

> 上述例题中，$\lambda^{*}=0$


## 例题

🌵 例题：利用原点位移法加速反幂法求解

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311121432305.png)
![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311121435670.png)



# 拉格朗日插值与牛顿插值


> “一维插值”概念了解：
> 
> 插值：用有限个离散点拟合函数，从而求未知的点
> 
> 一维：即一个自变量和一个因变量

🐳 一维插值作用：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310101114289.png)

🐳 插值思想：

本章学习的是用**多项式**去拟合离散点，即：$P(x){=}a_0+a_1x+.......+a_nx^n$ ，该式称为**插值多项式**

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111428406.png)

> 其中 $p$ 称为插值多项式
> $(x_{i},y_{i})$ 称为插值节点
> $p(x_i)=y_i$ 称为插值条件
> $[a,b]$ 称为插值区间
> 
> **注意**：构造的插值多项式一定要符合所有的插值条件，即从几何上来看，插值曲线一定要经过所有的插值节点

---
🐳 相关定理：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111434082.png)

> $n+1$ 个互异节点最高能构建**最高** $n$ 次的插值多项式，且是**唯一**的


## 拉格朗日插值

### 拉格朗日插值公式


🐳 **一次插值**

以**一次插值**（注意仍然是一维插值，只不过插值多项式是一次的）为例说明问题：

已知函数表如下，求满足 $L(x_0){=}y_0, L(x_1){=}y_1$ 的线性函数 $L(x)$ 

![image.png|475](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111503762.png)

$L(x)$ 可以写成为：
$$L(x)=\frac{x-x_0}{x_1-x_0}y_1+\frac{x_1-x}{x_1-x_0}y_0$$

记：$l_0(x)=\frac{x_1-x}{x_1-x_0}$ ，$l_1(x)=\frac{x-x_0}{x_1-x_0}$ ，$l_0(x)和l_1(x)$ 称为基函数，则 $L(x)$ 可以写为：
$$L(x)=l_0(x)y_0+l_1(x)y_1$$

可以看出，$L(x)$ 是由 2 个一次函数（$l_0(x),l_1(x)$ ）组合而成

基函数的性质：
- 对于 $l_0(x)$ ，当 $x=x_0$ 时，$l_0(x)=1$；当 $x=x_1$ 时，$l_0(x)=0$；当 $x_0{\leq}x{\leq}x_1$ 时，$0{\leq}l_0(x){\leq}1$。
- 对于 $l_1(x)$ ，当 $x=x_1$ 时，$l_1(x)=1$；当 $x=x_0$ 时，$l_1(x)=0$；当 $x_0{\leq}x{\leq}x_1$ 时，$0{\leq}l_1(x){\leq}1$。

---
🐳 **二次插值（插值多项式是二次的）**

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111513061.png)

可以看出，$L(x)$ 是由 3 个二次函数（$l_0(x),l_1(x),l_2(x)$ ）组合而成。

对应的基函数：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111519680.png)

二次插值的基函数仍然具有以上的性质

---
🐳 **n 次插值（插值多项式是 n 次的）**

n 次插值多项式形式为：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111525191.png)

基函数形式为：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111526338.png)

> 对于 $l_{k}(x)$ ，当 $x=x_k$ 时， $l_{k}(x)=1$；当 $x=x_{其它}$ 时，$l_{k}(x)=0$。根据这一性质，可以写出基函数 $l_{k}(x)$ 的数学表达形式。


### 拉格朗日插值误差分析

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310111536040.png)

> 参数解释：
> $R_n(x)$ 表示拉格朗日插值误差
> $f(x)$ 代表真实的函数
> $L_n(x)$  表示经过 n 次插值拟合出的函数多项式
> $f^{(n+1)}(\xi_n)$ 表示 $f(x)$ 的 $n+1$ 阶导数的任意值
> $\omega_{n+1}(x)=(x-x_0)(x-x_1)\cdots(x-x_n)$

💡 例题说明：

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310221629605.png)

> $(x-a)(x-b)$ 为二次函数，因此当 $x=\frac{a+b}2$ 时， $|(x-a)(x-b)|$ 取最大值


由以上例题可以得出以下结论：

🐳 在区间 $[a,b]$ 上取两端点作为插值点进行拉格朗日插值，误差满足： $|R(x)|\leq\frac M8(b-a)^2$ ，其中 M 为 $f(x)$ 二阶导数在 $[a,b]$ 上的最大值。

💡 例题

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310221658451.png)

> 由于要准确到小数后两位，因此误差要小于 $\frac12\times10^{-2}$ 。（这是个结论，也是解题的关键，要记住）

## 牛顿插值

### 牛顿插值公式

🔦 这里先举例说明牛顿插值是怎么回事：

有三个插值点：$P(x_0)=f(x_0),P(x_1)=f(x_1),P(x_2)=f(x_2)$ ，然后我构造了这样的多项式： $P(x){=}a_0+a_1(x-x_0)+a_2(x-x_0)(x-x_1)$ （注意观察多项式的特点），牛顿插值就是求解 $a_0, a_1, a_2$ 的这样一个过程。

为了求解，引入**差商**的定义：

![image.png|450](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222007867.png)
然后：
$$a_0=f(x_0),\quad a_1=f[x_0,x_1],\quad a_2=f[x_0,x_1,x_2]$$
则牛顿插值公式为：
$$
P(x) =f(x_0)+f[x_0,x_1](x-x_0) 
+f[x_0,x_1,x_2](x-x_0)(x-x_1)
$$
---
🐳 规范定义：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222014828.png)

> 🔥 如何记忆差商公式：
> 1、公式的形式为：（后半段差商-前半段差商）/最远两点之差
> 2、n 阶差商设计 n+1 个点

---
🐳 计算差商表

🍒例题 1：
![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222015046.png)

![IMG_20231022_203641_edit_19165804348116.jpg|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222037500.jpg)

> 列差商表的要点：
> 1、记住差商公式：$f[x_0,x_1,\cdots,x_n]=\frac{f[x_1,\cdots,x_n]-f[x_0,\cdots x_{n-1}]}{x_n-x_0}$ ，即：1、（后半段差商-前半段差商）/最远两点之差；2、n 阶差商设计 n+1 个点.
> 2、二阶差商涉及 3 个点，即从该点往上数的三个点，如下所示
> ![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111315038.png)


🍒 例题 2：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222039307.png)

### 牛顿插值误差

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310222047023.png)

### 例题

🌵 例题：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111427834.png)

> 题目要求求某点的近似值，则需取附近的插值点进行插值计算

## Hermite 插值

🐳 Hermite 插值定义：

给出一个函数及其某些**导数**在一组结点上的插值，求插值多项式 $H(x)$ 使其满足插值结点处的函数与（高阶）导数。

这里以“两点三次埃尔米特插值多项式”进行说明：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111543379.png)

针对于“两点三次埃尔米特插值多项式”有以下公式：

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111543458.png)

但是该公式比较难记，因此通常用牛顿差商表来求 hermite 多项式。

🐳 利用牛顿差商表计算 hermite 多项式

📺 [计算 hermite 多项式教学视频 1](https://www.bilibili.com/video/BV1D44y1X7PC?t=3.3)

📺 [计算 hermite 多项式教学视频 2](https://www.bilibili.com/video/BV1pD4y1Q75W?t=2.7)

🔥 关键点：用导数代替无意义差商，即：$f[x_0,x_1,\cdots,x_n]=\frac{f^{(n)}(n)}{n!}$

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111559824.png)

## 分段插值

### 三次样条插值函数的确定

🐳 三次样条插值函数的定义

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310230050312.png)

🍒 n+1 个插值点确定 n 个区间，在每个区间都构造一个三次多项式，每个多项式有 4 个参数。因此 **n 个三次多项式, 待定系数共4n 个**。（要注意，这里的 n 是指区间个数）

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231038290.png)

🍒 由样条定义,可建立方程(4n-2)个，因此需要补充两个条件：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231043037.png)

💡 例题说明：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231044035.png)
![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231045557.png)


# 数据拟合与函数逼近

🐳 拟合和插值的区别

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231328315.png)


 ## 数据拟合的最小二乘法

🐳 先以一次拟合函数说明数据拟合的线性模型：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231504859.png)

> 这里要看清 $G、X、F$ 分别是什么

🍒 $\text{GX=F}$ 是超定方程组

>什么是超定方程组：
>方程组的个数大于未知数个数，以上举例中，未知参数只有 2 个，但方程组有 m 个，$m > 2$ 。

🍒 以下**正规方程组**的解称为超定方程组的**最小二乘解**：
$$G^TGX^*=G^TF$$ 
对于**一次拟合**函数， $G$ 的快速求解公式：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231511210.png)


💡 例题 1:

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231510154.png)

💡 例题 2：

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231513896.png)
![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231513334.png)

---
🐳 规范说明数据拟合的线性模型：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231551954.png)

🍒记住和理解线性模型：
$$\varphi(x){=}a_0\varphi_0(x)+a_1\varphi_1(x)+\cdots\cdots+a_n\varphi_n(x)$$

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231554707.png)

🍒 将 m 个拟合数据代入拟合函数可得到 m 个方程。由于 $m>n+1$ （n+1 为未知参数个数），从而组成超定方程组。
🍒 这里要记住 $G$ 的写法规律。

![image.png|675](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310231600373.png)

🍒 正规方程组 $G^TGX=G^TF$ 的解称为超定方程组的**最小二乘解**
🍒 记住 $\mathbf{G}^{T}\mathbf{G}$ 和 ${\boldsymbol{G}}^{T}{\boldsymbol{F}}$ 的结构；

### 例题

🌵 例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111931991.png)

标准写法：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311111944218.png)


## 函数逼近

🔦 函数逼近思想：

若已知给定区间 $[a,b]$ 上的连续函数 $f(x)$，寻求一个简单、易于计算的函数 $P(x)$ 来代替 $f(x)$ ，即用 $P(x)$ 去近似 $f(x)$，这就是函数逼近要研究的问题。它与插值问题类似，都是在某一函数关系中求函数 $P(x)$ 使它与被逼近函数 $f(x)$ 之间满足一定的近似条件，但在这里，近似条件常用逼近函数与被逼近函数之间的某种“**距离**”来表示，并以此来确定两个函数在给定区间 $[a,b]$ 上的逼近程度如何。

### 最佳平方逼近

最佳平方逼近法用如下“距离”来表示逼近程度：
$$L=\int_a^b[P(x)-f(x)]^2dx=\min $$

#### 用 n 次多项式做最佳平方逼近

已知 $f(x)\in C[0,1]$， 求多项式 $P(x)=a_{0}+a_{1}x+a_{2}x^{2}+\cdots+a_{n}x^{n}$ ，使得：$L=\int_{0}^{1}[P(x)-f(x)]^{2}dx$ 取最小。

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310251355057.png)
![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310251357604.png)

> 其中，$a_k$ 为 $\varphi _{k}(x)$ 的系数， $b_{k}=(\varphi _{k}(x),f(x))$ 

#### 例题

🌵 例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311112020015.png)


#### 用正交函数系做最佳平方逼近

##### 正交函数系与正交多项式介绍

###### 正交函数系

🐳 正交函数系的概念 ：

🍒 函数内积

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310250937312.png)

🍒 函数带权正交

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310250939302.png)

> 记住特例：当 $\rho(x)=1$ 时，为“正交”

🍒 正交函数系

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310250944245.png)

💡 举例说明正交函数系：

![image.png|825](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310250947880.png)

###### 正交多项式

🐳 正交多项式概念：

设有多项式 $P(x)=a_{0}\varphi _{0}(x)+a_{1}\varphi _{1}(x)+a_{2}\varphi _{2}(x)+\cdots+a_{k}\varphi _{k}(x)$，$\rho(x)$ 是区间 $[a,b]$ 上的权函数，若多项式序列 $\left\{\varphi_{k}\left(x\right)\right\}\left(k=0,1,2,\cdots\right)$ 满足关系式：
$$(\varphi_j(x),\varphi_i(x))=\int_a^b\rho(x)\varphi_j(x)\varphi_i(x)\mathrm{d}x=\begin{cases}0,&j\neq i,\\A_i>0,&j=i,\end{cases}$$
则称 $P(x)$ 为正交多项式

> 可以这样理解：正交多项式可以由正交函数系线性组合而来

🍒 常见的正交多项式：

- 勒让德多项式

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310282134099.png)


🍐 递推关系：

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310262050485.png)


- 切比雪夫多项式

🍐 定义在区间 $[-1,1]$ 上，令 $x=\cos\theta$ ，则多项式的形式为：
$$T_{0}\left(x\right)=1,\quad T_{1}\left(x\right)=\cos(\arccos x)=\cos\theta,\quad T_{n}\left(x\right)=\cos(n\arccos x)=\cos\left(n\theta\right)$$

🍐 递推关系：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310262049872.png)


##### 正交函数系做最佳平方逼近

![image.png|950](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310251447778.png)

💰 结论：

$[a,b]$ 区间上的正交多项式 $P_{0}(x),P_{1}(x),\cdots,P_{n}(x)$ ，$f$ 为被逼近函数，利用最佳平方逼近可构造逼近函数：
$$P(x)=\frac{(P_{0},f)}{(P_{0},P_{0})}P_{0}(x)+\frac{(P_{1},f)}{(P_{1},P_{1})}P_{1}(x)+\cdots+\frac{(P_{n},f)}{(P_{n},P_{n})}P_{n}(x).$$
其中：$(P_k,f)=\int_a^bP_k(x)f(x)dx$

❓如何构造规定区间内的正交多项式？

# 数值积分

## 插值型求积公式

🐳 推导过程：（本章的插值都是使用拉格朗日插值）

![image.png|775](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310251944573.png)

🍒 核心思想是：利用拉格朗日插值近似函数，然后进行积分 ：
$$\int_{a}^{b}f(x)dx\approx\sum_{j=0}^{n}A_{j}f(x_{j})$$
其中：$A_j=\int_a^bl_j(x)dx$ ，$l_j(x)$ 为基函数

🍒 一般来说，积分公式是由**权重**和**求积节点**的组合来构造，通常积分关系可以写成如下形式：

$$\int_{-1}^1f(x)\mathrm{d}x\approx\sum_{i=1}^nw_if(x_i)$$

### 梯形公式

#### 原始梯形公式

🍒 推导过程：

![image.png|1050](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310251959071.png)

🍒 梯形公式：
$$\int_{a}^{b}f(x)dx\approx\frac{b-a}{2}[f(a)+f(b)]$$
> 只是使用单个直线函数来近似积分。(直线函数是通过拉格朗日插值得到的)

🍒 误差为：
$$R=I(f)-T_1(f)=-\frac{(b-a)^{3}}{12}f^{\prime\prime}(\eta)$$

> $I(f)$ 表示原函数的积分， $T_1(f)$ 表示使用 1 个区间的梯形公式
> 
> 梯形公式是用**拉格朗日一次插值**结果来进行积分


#### 复合梯形公式

🍒  复合梯形公式:

![image.png|700](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310252029515.png)

> 只需记公式
> 
> 与原始梯形公式不同的是，复合梯形公式将区间进行 n 等分，然后对每个小区间利用单个直线函数来近似积分然后累加。(直线函数是通过拉格朗日插值得到的)

🍒 如何理解并记住这个公式：

将 $[a,b]$ 区间进行 n 等分，对每个区间都采用原始的梯形积分公式，然后将结果进行累加，最后会发现除了区间两端点只计算了一次，中间的点都计算了两次，所以得到上述的积分表达式。

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310261716794.png)


🍒  复合梯形公式误差:

$$I(f)-T_n(f)=-\frac{\left(b-a\right)h^2}{12}f^{\prime\prime}(\xi_h)$$

> 其中 $h$ 为细分子区间的长度， $\xi_{h}\in[a,b]$ 取决于 $h$，$I(f)$ 表示原函数的积分，$T_n(f)$ 表示使用 n 个子区间的梯形公式。
> 
> 由误差公式可以看出，该方法的收敛速度是 $O(h^2)$ ，直观的解释是：积分下区间的长度减少一半，则误差下降大约 4 倍。

🌱例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310261641727.png)

> 🔥 注意：误差最大值是指绝对值最大，因此要求的是 $f^{^{\prime\prime}}(x)$ 最大绝对值


#### 改进梯形公式

（这一部分原理不需要管，只要记忆）

经过其它方式计算，复合梯形公式误差可以写为如下形式：
$$I(f)-T_{n}\left(f\right)\approx-\frac{1}{12}h^{2}\left(f^{\prime}\left(b\right)-f^{\prime}\left(a\right)\right)$$
根据这个误差公式，可以得到改进后的梯形公式：
$$T_{n}^{C}(f)=T_{n}(f)-\frac{1}{12}h^{2}[f^{\prime}(b)-f^{\prime}(a)]$$
其中 $T_{n}(f)$ 为复合梯形公式

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310300009781.png)


### Simpson 公式

#### 原始 Simpson 公式

🍒 公式推导

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310252012420.png)

🍒 Simpson 公式：
$$\int_a^bf(x)dx\approx\frac{b-a}6[f(a)+4f(\frac{a+b}2)+f(b)]$$
> 与梯形公式不同的是，Simpson 公式是使用单个抛物线函数来近似积分。(抛物线函数是通过拉格朗日插值得到的)


#### 复合 Simpson 公式

🍒 公式为：
$$\sum_{i=1}^{n/2}\frac{h_{i}}{3}[f(x_{2i-2})+4f(x_{2i-1})+f(x_{2i})]$$
其中：$h_{i}=(x_{2i}-x_{2i-2})/2$ 

> 复合 Simpson 公式将区间进行 n 等分，然后对每两个小区间利用单个抛物线函数来近似积分然后累加。(抛物线函数是通过拉格朗日插值得到的)

注意：复合 Simpson 公式中的 $h_{i}$ 就是指单个子区间，而原始 Simpson 公式中的 $b-a$ 包含了两个子区间，因此两个公式的分母一个是'3'，一个是'6'。

![image.png|300](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310261735290.png)


🍒 公式简化：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310261729595.png)

🍒如何理解并记住公式：

将 $[a,b]$ 区间进行 n 等分，对每两个子区间都采用原始的 Simpson 积分公式，然后将结果进行累加。注意，一次 Simpson 积分使用两个子区间，因此最后只需使用 $\frac n 2$ 次公式 。（复合 Simpson 公式看那个简化版的可能更好记）

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310261742933.png)



### 高斯型数值求积公式

#### 代数精度

若一个求积公式对所有次数不超过 $m$ 的多项式都准确成立，而对某一个 $m+1$ 次的多项式不准确成立，则称该求积公式具有 $m$ 次代数精度。

定义等价于：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310262126699.png)


🍒 相关结论
- （n＋1）点插值型求积公式代数精度至少为 n 阶，最高为 2n+1 阶

> 当求积公式中有（n＋1）个求积点，且求积点都被指定时，求积公式最少有 n+1 个未知权重，则至少可以列 n+1 个方程，代数精度最少到 n 阶
> 当求积公式中有（n＋1）个求积点时，但求积点未被指定，同时求积公式最少有 n+1 个未知权重，则至少可以列 2n+1 个方程，代数精度最少到 2n+1 阶

- 中点公式和梯形公式（2 个求积点）的代数精度为 1 阶，Simpson 公式（3 个求积点）的代数精度为 3 阶。

🌱 例题 1:

[例题讲解视频](https://www.bilibili.com/video/BV1vr4y1U723?t=360.7&p=14)

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310262146763.png)

🌱 例题 2 ：

[例题讲解视频](https://www.bilibili.com/video/BV1ED4y1e7uH?t=150.3)

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310281024148.png)

💰 解题思路——“求解积分公式的参数从而使代数精度尽可能高？” 

- 确定未知参数个数
- 依次将 $f(x)=1,x,x^2\cdots$ 代入积分公式中，从而列出方程组求解未知参数。（有 n 个未知参数，$f(x)$ 就取到 $x^{(n-1)}$ ，就可以列出 n 个方程组）
- 继续取 $f(x)=x^n$，代入积分公式中（此时积分公式中的各个参数都已经确定），判断积分公式左右两端是否相等。如果不相等，则代数精度为 n-1；如果相等，则继续代入 $x^{(n+1)}$ 以确定代数精度。


#### 高斯求积公式

📺 [讲解视频](https://www.bilibili.com/video/BV1ve411L7db?t=11.3)

🐳 引例

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310282203079.png)

当求积点未被随意指定（而是通过某种方式求出来的，即后面要学习的高斯节点），权重未知时，可列的方程组个数最多，求出来的积分公式代数精度最高

---
🐳 Gauss 节点、Gauss 系数与 Gauss 求积公式的定义

使积分公式 $\int_{-1}^1f(x)\mathrm{d}x\approx\sum_{i=0}^nw_if(x_i)$ 达到最高代数精度 2n+1 阶的节点为 Gauss 节点，相应的求积公式为 Gauss 求积公式，系数 $w_i$ 为 Gauss 系数。

> Gauss 求积公式仍然是插值型求积公式
> 
> Gauss 系数可通过 Gauss 节点和拉格朗日基函数得到
> 
> 构造 Gauss 求积公式的关键在于确定 Gauss 点：
> 1、待定系数法：依次 $f(x)=1,x,x^2\cdots$ 代入积分公式中，从而列方程组求解未知参数（非线性方程组求解困难，不推荐）
> 2、求以 Gauss 节点为零点的正交多项式，再构造 Gauss 求积公式（后面重点介绍）


##### 高斯节点与正交多项式

🍒 高斯节点与正交多项式之间的关系：

求积节点 $x_{i},(i=0,1,\cdots,n)$ 是 Gauss 节点
$\leftrightarrow$ （等价于）
在区间 $[a,b]$ 上以这组节点为零点的 $n+1$ 次多项式 $\pi(x)=(x-x_{0})(x-x_{1})\cdots(x-x_{n})$ 与所有次数不超过 $n$ 次的多项式 $P(x)$ 都正交即 $\int_{a}^{b}\pi(x)P(x)dx=0$

🍒 重要推论：

 $[a,b]$ 上的 $n+1$ 次正交多项式的 $n+1$ 个零点就是 Gauss 求积公式的 Gauss 节点


##### 构造 Gauss－Legendre 积分公式

🐳 利用 Legendre 多项式求高斯节点从而构造 Gauss－Legendre 积分公式

求解流程为：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310291346945.png)

🌟注意：Legendre 多项式是定义在 $[-1,1]$ 上的正交多项式，因此构造出的积分公式的积分区间必须为 $[-1,1]$

🍒 求高斯节点：

Legendre 多项式 $P_{n}(x)$ 是 $[-1,1]$ 上带权 $\rho(x)=1$ 的正交多项式，三项之间的递推关系如下所示：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310291452194.png)


利用 $P_{n+1}(x)$ 在 $[-1,1]$ 上的 $n+1$ 个零点充当高斯节点

🍒 求权重系数：
- 方法一：依次将 $f(x)=1,x,x^2\cdots$ 代入积分公式，列方程组求权重系数。（这种方法只适合用于未知权重系数较少的情况下，至多 3 个。因为当个数多了，解方程组会比较麻烦）

![image.png|550](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310291612544.png)

- 方法二：利用拉格朗日基函数公式求权重系数
$$w_{i}=\int_{-1}^{1}l_{i}^{(n)}(x)\mathrm{d}x$$
其中：$l_{i}^{(n)}(x)=\prod_{k=0,k\neq i}^{n}\frac{x-x_{k}}{x_{i}-x_{k}}$

💡这里解释一下为什么可以这样表示：

当有 $n+1$ 个节点时，可以使用拉格朗日插值公式进行函数近似，然后求积分。有 $n+1$ 个节点，就有 $n+1$ 个基函数，对每个基函数进行积分即可得相应的权重系数。

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310292134413.png)
![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311120044347.png)


🍒 最终构造 Gauss－Legendre 积分公式 $\int_{-1}^{1}f(x)dx\approx\sum_{i=0}^{n}\omega_{i}f(x_{i})$ 。

---
- 为了方便计算，列出了 Gauss 点以及对应 Gauss 系数表格，用的时候直接查表即可（需要记住 1 点、2点、3点公式）：

![image.png|500](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310292146503.png)

- 由于勒让德正交多项式是定义在 $[-1,1]$ 区间上的，因此上述构造的积分公式的积分区间必须在 $[-1,1]$ ，当积分区间不是这个时，要通过变换使其满足这个条件，如下题所示：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310292203000.png)

更一般的形式为，当积分区间为 $[a,b]$ 时，可通过如下变换，使积分区间变为 $[-1,1]$：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310301010398.png)

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310301015814.png)

### 龙贝格求积公式

[讲解视频](https://www.bilibili.com/video/BV1xe4y1c7gq?t=1.4&p=9)

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202310302113384.png)



# 常微分方程的数值解法

📖[[微分方程的基本概念]]
📺 [常微分方程的数值解法教学视频](https://www.bilibili.com/video/BV1mK411M7uH?t=4.2)

---
🍒 本章考虑的是**一阶常微分方程**初值问题，其形式如下：

$$\begin{cases}\frac{dy}{dx}=f(x,y),&\text{或}\\y(x_0)=y_0\end{cases}\quad\begin{cases}y^{\prime}=f(x,y),\\y(x_0)=y_0\end{cases}$$

---
🍒 求一阶常微分方程的解可以采用高数的解析解法（对方程两边同时积分，然后代入初值，即可得相应的函数），但这种方法在工程应用上较难，因此这里学习**数值解法**：

![image.png|800](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081517648.png)

> 求 ${y(x)}$ 在离散节点 $x_1<\cdots<x_n<\cdots$ 上的近似值 $y_{1},\cdots,y_{n},\cdots$


## 欧拉格式与改进欧拉法

📺 [欧拉法以及改进视频讲解](https://www.bilibili.com/video/BV1YS4y1B74k?t=2.5)

### 向前差商和向后差商

取定步长：$h$ ，记 $x_{n}=x_{0}+nh$ 。

🍒 利用一阶向前差商近似导数：

$$\frac{y(x_{n+1})-y(x_{n})}{h}\approx y^{\prime}(x_{n})=f(x_{n},y_{n})$$

---
🍒 利用一阶向后差商近似导数：
$$\frac{y(x_{n})-y(x_{n-1})}{h}\approx y^{\prime}(x_{n})=f(x_{n},y_{n})$$
通常将上式写成如下形式：
$$\frac{y(x_{n+1})-y(x_{n})}{h}\approx y^{\prime}(x_{n+1})=f(x_{n+1},y_{n+1})$$
> 这个形式用的比较多，该式左边是差商，右边是导数


### 显式欧拉格式

🍒 将“一阶向前差商近似导数等式”进行变形，可得到显式欧拉格式：
$$y_{n+1}=y_n+hf(x_n,y_n)$$
> $f(x_n,y_n)$ 是指在 $x_n$ 处的导数。
> 这个公式由差商推导而来，但理解的时候尽量不要和差商联系起来（很容易理解不清楚），所以就纯看这个公式的形式并联系该公式的几何意义来理解即可。

🍒 显式欧拉格式的数学意义：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081553413.png)

> 从当前时刻出发，根据当前点的函数值及其导数，可得到下一点的函数值，因此显式欧拉法又称为**前向欧拉公式**

🍒 显式欧拉格式的几何意义：

![image.png|475](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081605797.png)

### 隐式欧拉格式

🍒 将“一阶向后差商近似导数等式”进行变形，可得到隐式欧拉格式：
$$y_{n+1}=y_n+hf(x_{n+1},y_{n+1})$$
> $f(x_{n+1},y_{n+1})$ 是指在 $x_{n+1}$ 处的导数，因为 $f(x_{n+1},y_{n+1})$ 中包含 $y_{n+1}$ ，是要求解的量，因此称该格式为“隐式”。求解时，需要求解关于 $y_{n+1}$ 的方程组，因此求解比较麻烦。
> 这个公式由差商推导而来，但理解的时候尽量不要和差商联系起来（很容易理解不清楚），所以就纯看这个公式的形式并联系该公式的几何意义来理解即可。

🍒 隐式欧拉格式的几何意义：

![image.png|500](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081610225.png)

---
🌟 显式欧拉格式和隐式欧拉格式的最大区别在于：显式欧拉格式步长 $h$ 乘的是 $x_n$ 处的导数，隐式欧拉格式步长 $h$ 乘的是 $x_{n+1}$ 处的导数

### 梯形公式

🍒 公式形式为：
$$y_{n+1}=y_{n}+\frac{h}{2}\left(f(x_{n},y_{n})+f(x_{n+1},y_{n+1})\right)$$
🍒 理解：
显式欧拉格式步长 $h$ 乘的是 $x_n$ 处的导数，隐式欧拉格式步长 $h$ 乘的是 $x_{n+1}$ 处的导数，为了更加精确，梯形公式的步长 $h$ 乘的是 $x_n$ 处的导数和 $x_{n+1}$ 处的导数的平均值。

> 显式欧拉公式使用方便，但精度低
> 梯形公式精度更高，但却包含隐式公式，求解比较麻烦

### 改进欧拉公式

🍒 为什么采用改进欧拉公式

显式欧拉公式使用方便，但精度低；梯形公式精度更高，但却包含隐式公式 $y_{n+1}$，求解比较麻烦。为此这里采用**改进欧拉公式**，用一个预测值 $\overline{y_{n+1}}$ 替代 $y_{n+1}$

🍒 改进欧拉公式

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081650160.png)


## 局部截断误差与收敛阶

🐳 局部截断误差定义：

任意取一个点 $x_n$，假设它之前的计算都没有误差，计算到 $x_{n+1}$ 点处，产生的误差为局部截断误差，用如下形式表示：
$$T_{n+1}=y(x_{n+1})-y_{n+1}$$
其中 $y(x_{n+1})$ 为真实值，$y_{n+1}$ 为迭代出的值

---
🐳 收敛阶定义：

若某算法的局部截断误差为： $O(h^{p+1})$，则称该算法有 $p$ 阶精度

---
🐳 显式 Euler 法的误差及收敛阶分析：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081709879.png)

> 对 $y(x_{n+1})$ 在 $x_n$ 处进行泰勒展开

---
🐳 隐式 Euler 法的误差及收敛阶分析：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081712935.png)

> 对 $y(x_{n+1})$ 以及 $y^{\prime}(x_{n+1})$  在 $x_n$ 处进行泰勒展开

---
🐳 梯形法的误差及收敛阶分析：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311081911192.png)

> 对 $y(x_{n+1})$ 以及 $y^{\prime}(x_{n+1})$  在 $x_n$ 处进行泰勒展开

---
🐳 经过计算，改进的 Euler 法是2阶精度


## 龙格库塔法

### 引例

🌵 不管什么方法，都是根据当前点的值，去确定下一点的值

🍒 Euler 法根据 1 个点的值确定下一个点，有 1 阶精度：

![image.png|550](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082323265.png)

🍒 改进的 Euler 法根据 2 个点的值确定下一个点，有 2 阶精度：

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082326873.png)

❓那么如果能**多取几个点来确定下一个点**，是不是精度会更高呢？为此有了**龙格-库塔法**


### 龙格-库塔法

🌵 龙格-库塔法基本思想

在 $[x_n,x_{n+1}]$ 内多预报几个点的 $k_i$ 值，并用其加权平均值作为 $K$ 的近似值从而构造出具有更高精度的计算公式。

---
🌵 龙格-库塔数学一般形式

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082336129.png)

---
🌵 一阶龙格-库塔公式

![image.png|625](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082342645.png)

> 即为显式欧拉法

---
🌵 二阶龙格-库塔公式

![image.png|600](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082344778.png)

🌟 注：
![image.png|425](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082346665.png)

> 当取 $b_1$，$b_2$ 为 $1/2$，$c_2$，$a_{21}$ 为 $1$ 即为 Euler 改进公式

---
🌵 三阶龙格-库塔公式

![image.png|575](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082348789.png)

🌟 一般使用如下一般形式

![image.png|525](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311090917981.png)


---
🌵 四阶龙格-库塔公式一般形式

![image.png|525](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311082350792.png)

> 四阶龙格-库塔公式一般形式常用


## 例题

🌵例题：

![image.png](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311091448757.png)

---
🌵例题：

![image.png|725](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311091020321.png)

> 引入一个中间参数，将二阶方程初值问题转化为两个一阶方程的初值问题

---
🌵 例题：

![image.png|650](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311091116656.png)

> 这里需要运用指数函数 $e^x$ 的定义： $\lim_{h\to0}(1+h)^{\frac{1}{h}} = e$

🍁解题思路：梯形公式的运用

🔥犯的错误：将梯形公式和欧拉改进公式混淆

---
🌵 例题：

![image.png|750](https://zbn-picture1-1319009493.cos.ap-chengdu.myqcloud.com/public-pic/202311091210292.png)
